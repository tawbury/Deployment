# infra/helm/observer/values-prod.yaml
# ============================================================
# Production Environment Overrides
# ============================================================
# 이 파일은 운영 환경에서 values.yaml을 override합니다.
# helm install -f values.yaml -f values-prod.yaml observer .
# ============================================================

app:
  env: production
  logLevel: INFO
  logFormat: json
  # Config Loader - 운영 K8s 환경 설정 (명시적 선언)
  runMode: container
  deploymentMode: kubernetes

observer:
  swingIntervalMinutes: 5
  scalpMaxSlots: 41
  minSymbolCount: 2500
  minPrice: 4000

resources:
  requests:
    memory: "512Mi"
    cpu: "250m"
  limits:
    memory: "2Gi"
    cpu: "2000m"

probes:
  startup:
    initialDelaySeconds: 15
    failureThreshold: 40   # 최대 200초 대기 (운영 부트스트래핑 시간 고려)
  liveness:
    initialDelaySeconds: 60
    periodSeconds: 30
    failureThreshold: 3
  readiness:
    initialDelaySeconds: 20
    periodSeconds: 15

# 운영 환경 복제본 - 1개 운영 (Stateful Collector)
# ScalpCollector가 동일 hostPath JSONL에 쓰므로 다중 Pod 경쟁 발생
# 2→1 변경 사유: 이중 Pod가 같은 KIS WebSocket 계정으로 경쟁하여 scalp 데이터 중단 (2026-02-13)
replicaCount: 1
