# Observer 앱 전용 base (Port 8000, /health)
# 이미지 태그는 overlays에서 YYYYMMDD-HHMMSS 형식으로 지정
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  #- namespaces/observer.yaml

  # PostgreSQL (StatefulSet으로 전환 - Phase 2)
  # - deployments/postgres.yaml  # ← Deployment (레거시, 백업됨)
  - statefulsets/postgres.yaml   # ← StatefulSet (권장)

  - deployments/observer.yaml
  - services/postgres.yaml
  - services/observer-svc.yaml
  - configmaps/observer-config.yaml

  # Secrets 관리
  # observer-secrets: kubectl create secret 로 생성 (secrets/observer-secrets.yaml 가이드 참고)
  # 또는 SealedSecrets 사용 (sealed-secrets/README.md 참고):
  # - sealed-secrets/observer-sealed-secrets.yaml

  # Persistent Volume Claims
  - pvc/observer-db-pvc.yaml
  - pvc/observer-logs-pvc.yaml
  - pvc/observer-data-pvc.yaml

  # - ingress/observer-ingress.yaml  # 외부 노출 시 주석 해제

commonLabels:
  app.kubernetes.io/name: observer
  app.kubernetes.io/managed-by: kustomize
  app.kubernetes.io/part-of: tawbury-deployment

commonAnnotations:
  k8s.tawbury/version: "2.0.0"
